# Обзор существующих решений задачи оценки текущей ситуации в среде виртуального футбола 
Ключевые слова: виртуальный футбол, оценка ситуации, проект Robocup
## Аннотация
В данной работе произведен обзор, сравнение и анализ преимуществ и недостатков алгоритмов оценки ситуации в среде виртуального футбола проекта Robocup. Сравнение алгоритмов производилось по таким критериям как уровень оценки ситуации, результат разработки и точность оценки ситуации. В результате установлено, что решение будет основываться на уже существующих алгоритмах, а наиболее подходящими для этого алгоритмами являются алгоритм, совмещающий нечеткую и бинарную логику и вероятностный алгоритм.
## Введение
Среда виртуального футбола создавалась для исследования мультиагентных систем и искусственного интеллекта, реалистичность достигалась за счет динамической среды реального времени, в которой действия классифицируются за ограниченный промежуток времени [1]. Оценка ситуации и принятие решения в такой среде является достаточно сложной задачей, а преодоление проблем в процессе ее решения может значительно продвинуть исследования в области мультиагентных систем и искусственного интеллекта [2]. 
На данный момент для задачи оценки текущей ситуации в среде виртуального футбола не найдено универсальное решение, причем для разных моделей поведения агента в среде разные алгоритмы имеют свои преимущества и недостатки [3]. В свою очередь, алгоритмы, основанные на нечеткой логике, могут решать задачи, связанные с работой с неполными данными, а также с координацией действий нескольких агентов [4].
Объектом исследования являются агенты среды виртуального футбола. Предметом исследования является оценка текущей ситуации в среде виртуального футбола.
Целью данной статьи является выявление преимуществ и недостатков существующих методов и алгоритмов для оценки ситуации в среде виртуального футбола
Для достижения поставленной цели в ходе исследования были решены следующие задачи:
1. Обзор существующих моделей и алгоритмов для оценки текущей ситуации в среде виртуального футбола
2. Определение критериев сравнения алгоритмов оценки текущей ситуации в среде виртуального футбола
3. Сравнение алгоритмов по выбранным критериям
4. Анализ результатов сравнения алгоритмов.
## Обзор предметной области
В качестве аналогов рассмотрены алгоритмы оценки текущей ситуации и принятия решений в среде виртуального футбола “Robocup”.
В поисковой системе google schoolar был произведен поиск алгоритмов оценки текущей ситуации для виртуальной мултиагентной среды robocup. Поиск производился по запросам “robocop virtual soccer”, “decision making algorithm”. В качестве источников аналогов рассматривались научные статьи с описанием используемых методов решения задачи и реализованных результатов. Для рассмотрения широкого диапазона возможных решений поставленной задачи выбирались аналоги, для которых эти критерии не совпадали
### Алгоритм NOVAURO 
Алгоритм NOVAURO – это модель принятия решений, основанная на двух критических факторах: вертикальном расстоянии до линии ворот и визуальном угле к воротам. С их помощью формализуются оборонительные и наступательные решения.
Перед выполнением действия рассчитывается функция оценки успеха. 
При любом действии (удар по мячу, передача мяча, защитная ситуация) результат зависит от вертикального расстояния от агента до линии ворот и от угла обзора до ворот.
Кроме того, результат функции оценки успеха удара по мячу зависит от способности бьющего агента и степени вмешательства агентов соперника. Результат функции оценки успеха передачи также зависит от качества коммуникации, в том числе надежности секретного сообщения, которое сообщает о точке передачи мяча. [5]
### Гибридный метод, совмещающий нечеткую и бинарную логику 
Метод основан на разделении действий агента среды на базовые, то есть реализованные сервером, и действия высокого уровня. Для принятия решения используется двухфазные алгоритм, основанный на сочетании нечеткой и бинарной логики
Перед выполнением действия агент оценивает его как успешное либо неуспешное.
Удар по мячу, направляющий его в конкретную точку ворот оценивается как успешный если время, необходимое защитнику, чтобы поймать мяч, больше, чем сумма времени корректировки положения агента с временем полета мяча до точки
При передаче мяча другому агенту вычисляется возможность ошибки и риски перехвата мяча, учитывается местоположение мяча и агента – получателя мяча
При защитной ситуации агент оценивает необходимость сближения с агентом соперника и при необходимости помечает его как свою цель для выполнения сценария защиты. [6]
### Алгоритм на основе изучения примитивных навыков через обучение с подкреплением 
Алгоритм представляет собой алгоритм обучения с подкреплением PPO (алгоритм оптимизации проксимальной политики), расширенный с помощью способностей, использующих симметрию, и примитивов набора навыков. Эти примитивы являются подмножеством примитивов движения и фиксируют общие шаблоны действий.
Более сложные действия, такие как удар по мячу либо передача мяча реализованы как набор примитивных навыков. 
Удар по мячу реализован как навык “Sprint-kick” и состоит из трех этапов: спринт вперед для набора скорости, кривой спринт для изменения траектории, удар ногой.
Передача мяча реализована с помощью высокоуровневой обработки навыка “Push”. Высокоуровневая часть навыка отрабатывается в мультиагентной среде, анализируя данные о ближайших агентах – товарищах по команде и агентах – соперниках. При взаимодействии всегда принимается во внимание долгосрочная цель – направление ворот соперника, но действие передачи мяча выполняется исходя из краткосрочной цели – ближайшего товарища по команде, которому можно передать мяч. [7]
### Вероятностный алгоритм 
Алгоритм основан на использовании базовой станции для предоставления навыков, информации о мире и путях, оставляя при этом автономность робота. Базовая станция улучшает принятие решений на основе вероятностных алгоритмов и деревьев решений. 
Для реализации методов удара по мячу и передачи мяча используется навык “Удар ногой”, зависящий от параметров координат точки назначения, а также перемнной силы удара, принимающей значения удар по воротам либо передача мяча
Для реализации защитной модели поведения используется навык “Покрытие”. Его цель – позиционировать агента между двумя координатами (в том числе движущимися). Навык зависит от параметров координат позиционирования, а также уровня давления в процентном соотношении, которое необходимо оказать на агента соперника. [8]
### Усовершенствование алгоритма цепочки действий 
Алгоритм представляет собой улучшение цепочки действий с помощью специальных эвристик, улучшающих работу команды в критических областях.
Поле разделяется на 8 зон, для каждой произведена оптимизация оценки цепочки действий. 
Выбор оборонительной и наступательной стратегии реализуется с использованием нейронной сети, вычисляющей вероятность забить гол
При владении мячом игрок вычисляет расстояние до всех игроков своей команды, что позволяет ему улучшать позиционирование для передачи мяча
Эвристика защитной стратегии основана на уменьшении свободного пространства игрока соперника и создании возможностей для своей атаки на игрока соперника, владеющего мячом. [9]
## Критерии сравнения аналогов
Для сравнения аналогов выбраны следующие критерии 
### Уровень оценки ситуаци
Уровень оценки ситуации – этот критерий показывает, исходя из каких данных агент принимал решение. Локальный уровень оценки ситуации говорит о том, что агент принимает решение, исходя только из информации, которую считывает сам. Полный уровень оценки ситуации говорит об использовании информации о всех объектах среды с помощью внешнего сервера.
### Результат разработки
Результат разработки – этот критерий показывает, показывает реализованный в ходе разработки или исследования результат. Результат может являться новым алгоритмом принятия решения либо оптимизацией или усовершенствованием существующих методов и алгоритмов.
### Точность
Точность – этот критерий показывает, насколько точно в соответствии с алгоритмом принимается решение. Значение выражается в процентах о 0 до 100, где 100% - наиболее точное предсказание ситуации. 
Авторы разных статей с описанием алгоритмов оценки ситуациив в среде виртуального футбола приводят различные результаты тестирования работы алгоритмов. Поэтому точность вычисляется либо как отношение выигранных матчей ко всем сыгранным матчам, либо как отношение голов, забитых командой ко всем голам, забитым в матче, в зависимости от того, какие результаты тестирования работы алгоритма предоставляют авторы статьи.

## Таблица сравнения аналогов
| Алгоритм/Критерий          | Уровень оценки ситуации | Результат разработки             | Точность |
|----------------------------|-------------------------|----------------------------------|---------|
| Алгоритм NOVAURO           | Локальный               | Алгоритм принятия решений        | 64%     |
| Гибридный метод, совмещающий нечеткую и бинарную логику | Локальный | Алгоритм принятия решений | 81%     |
| Алгоритм на основе изучения примитивных навыков через обучение с подкреплением | Полный | Оптимизация существующего алгоритма | 76%     |
| Вероятностный алгоритм     | Полный                  | Алгоритм принятия решений        | 86%     |
| Алгоритм цепочек действий  | Локальный               | Оптимизация существующего алгоритма | 75%     |

## Выводы по итогам сравнения
Анализируя результаты сравнения по критериям из таблицы 1, а также описания аналогов можно сделать следующие выводы.
Для решения задачи при различных подходах используется как полный, так и локальный уровень оценки ситуации, выбор уровня оценки ситуации совершается исходя из особенностей используемого метода и реализации. Преимуществом полного уровня оценки ситуации является более полная оценка ситуации с использованием данных, недоступных одному игроку, однако по сравнению с локальным уровнем оценки ситуации такой метод требует участия сервера в оценке ситуации, а также большего количества вычислительных ресурсов и времени для связи с сервером.
Среди аналогов существует не только оптимизации и реализации одного подхода, но и новые алгоритмы принятия решений, следовательно, существует возможность анализировать различные алгоритмы и подходы к решению задачи. Среди аналогов представлены такие способы решения задачи, как аналитический алгоритм (NOVAURO), совмещение нечеткой и бинарной логики, алгоритм обучения с подкреплением, а также вероятностный алгоритм.
Оценивая точность алгоритмов, а также выводы авторов статей, можно сделать следующие выводы.
Алгоритм NOVAURO обладает низкой относительно других аналогов точностью. Авторы [5] связывают это с концепцией алгоритма, представляющей жесткую иерархическую модель.
Алгоритм, основанный на совмещении нечеткой и бинарной логики, имеет точность 81%, что по сравнению с другими представленными аналогами является достаточно высоким показателем. Из выводов, сделанных авторами статьи [6] можно увидеть, что такие показатели точности достигаются за счет двухфазного алгоритма принятия решений.
Алгоритм на основе изучения примитивных навыков имеет точность 76%, что по сравнению с другими аналогами является средним показателем. Его преимущество, как следует из выводов [7], в высокой скорости игроков, а также в возможности гибко переходить от одного поведения к другому. Однако в данном алгоритме отсутствует реализация защитной модели поведения
Вероятностный алгоритм обладает самой высокой среди представленных аналогов точностью. Авторы [8] утверждают, что алгоритм гибко адаптируется к различным игровым ситуациям, а устраняет необходимость в заранее определенных схемах и сборниках правил. Недостатком данного алгоритма можно считать снижение точности при работе в системах с высоким показателем шума, так как концепция алгоритма подразумевает активное взаимодействие игроков на поле.
Алгоритм на основе цепочек действий имеет точность 75%, что по сравнению с другими аналогами является средним показателем. Авторы [9] отмечают значительное улучшение позиционирования игроков для передачи мяча, а также поведения игроков в защитных ситуациях, однако использованные эвристики ухудшили поведение игроков в ситуациях удара по воротам по сравнению с алгоритмами, взятыми за основу
## Выбор метода решения
На основе проведенного анализа о разрабатываемом решении можно сказать следующее
1. Для решения задачи необходимо разработать алгоритм оценки ситуации в среде виртуального футбола. 
2. Алгоритм должен являться оптимизацией существующих алгоритмов оценки ситуации либо использовать подходы существующих решений, позволяющие улучшить результат.
3. Среди рассмотренных алгоритмов наиболее подходящими для оптимизации являются алгоритм, основанный на нечеткой логике [6] и вероятностный алгоритм [8]. Преимуществом алгоритма, основанного на нечеткой логике, является локальный уровень оценки ситуации, позволяющий получить преимущество в скорости работы. Преимуществом вероятностного алгоритма является гибкость и адаптивность к различным игровым ситуациям. Более детальное изучение особенностей применения каждого из методов является предметом изучения в дальнейших работах.
4. Решение, созданное на основе выбранного алгоритма, должно являться реализацией алгоритма оценки ситуации в среде виртуального футбола.
5. Реализованный алгоритм должен обеспечивать возможность оценки ситуации для выполнения агентом функциональностей удара по воротам, передачи мяча и защиты. Алгоритм должен обеспечивать точность оценки ситуации, не уступающую существующим аналогам
## Заключение
В статье проведен обзор алгоритмов оценки ситуации в среде виртуального футбола. После этого выбраны критерии сравнения алгоритмов для анализа преимуществ и недостатков каждого из них. В результате выявлено, что решение будет основываться на уже существующих алгоритмах, а наиболее подходящими для этого алгоритмами являются алгоритм, совмещающий нечеткую и бинарную логику и вероятностный алгоритм.
Направление дальнейших исследований:
1. Изучение особенностей применения различных методов и алгоритмов для решения задачи оценки текущей ситуации в среде виртуального футбола
2. Реализация метода оценки текущей ситуации в среде виртуального футбола с учетом информации, полученной в ходе изучения
## Список использованных источников
1.  Soccer server: A tool for research on multiagent systems. Itsuki Noda, Hitoshi Matsubara, Kazuo Hiraki & Ian Frank (1998) - https://www.tandfonline.com/doi/abs/10.1080/088395198117848
2.  Fear Learning for Flexible Decision Making in RoboCup: A Discussion. C Rizzi, CG Johnson, PA Vargas (2017) - https://link.springer.com/chapter/10.1007/978-3-030-00308-1_5
3.  Design and Implementation of a General Decision-making Model in RoboCup Simulation. Changda Wang, Xianyi Chen, Xibin Zhao, and Shiguang Ju (2004) - https://journals.sagepub.com/doi/full/10.5772/5811
4.  Review of Applications of Fuzzy Logic in Multi - Agent Based Control. Dilum Hettiarachchi, K T M U Hemapala, Buddhika Jayasekara (2018)  https://www.researchgate.net/publication/329913683_Review_of_Applications_of_Fuzzy_Logic_in_Multi_-Agent_Based_Control_System_of_AC-DC_Hybrid_Microgrid
5. Design and Implementation of a General Decision-making Model in RoboCup Simulation  Changda Wang, Xianyi Chen, Xibin Zhao, Shiguang Ju https://arxiv.org/abs/cs/0411023
6. A simple method for decision making in RoboCup  soccer simulation 3D environment  Khashayar Niki Maleki, Mohammad Hadi Valipour, Sadegh Mokari, Roohollah Yeylaghi Ashrafi, Mohammad Reza Jamali, Caro Lucas https://arxiv.org/abs/1212.1570
7. Designing a Skilled Soccer Team for RoboCup: Exploring Skill-Set-Primitives through Reinforcement Learning Miguel Abreu, Luis Paulo Reis, Nuno Lau https://arxiv.org/abs/2312.14360
8. Probability-Based Strategy for a Football Multi-Agent Autonomous Robot System António Fernando Alcântara Ribeiro, Ana Carolina Coelho Lopes, Tiago Alcântara Ribeiro, Nino Sancho Sampaio Martins Pereira, Gil Teixeira Lopes António Fernando Macedo Ribeiro https://www.researchgate.net/publication/376801345_Probability-Based_Strategy_for_a_Football_Multi-Agent_Autonomous_Robot_System
9. ITAndroids 2D Soccer Simulation Team Description Paper 2017 Felipe Coimbra, Miguel Neto, Camila Rapereda, Guilherme Marinot, Cl´audio Silva,Matheus Marcontes https://archive.robocup.info/Soccer/Simulation/2D/TDPs/RoboCup/2017/ITAndroids_SS2D_RC2017_TDP.pdf